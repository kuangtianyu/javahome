# 处理分类

### 7.1.1 异常分类

- 在 Java 语言中，异常对象都是派生于 Throwable 类的一个类实例。如果Java中内置的类不能满足需求，用户还可以创建自己的异常类
- 所有的异常类都是由 Throwable 继承而来，在下一层被分解为两个分支：Error 和 Exception
- Error 类层次结构描述了 Java 运行时系统的内部错误和资源耗尽错误
- Exception分解为两个分支：一个分支派生于 RuntimeException；另一个分支包含其他异常。
- 一般规则是：由编程错误导致的异常属于 RuntimeExcepiton；如果程序本身没有问题，但由于像 I/O 错误这类问题导致的异常属于其他异常
- 派生与RuntimeException的异常包括以下问题
  - 错误的强制类型转换
  - 数组访问越界
  - 访问null指针
- 不是派生于RuntimeExcepiton的异常包括：
  - 试图超越文件末尾继续读取数据
  - 试图打开一个不存在的文件
  - 试图根据给定的字符串查找Class对象，而这个字符串表示的类并不存在
  - 如果出现RuntimeException异常，那么就一定是你的问题
- Java语言规范将派生于 Error类或RuntimeException 类的所有异常称为`非检查型`异常，所有其他的异常称为`检查型`异常

### 7.1.2 声明检查型异常

- 需要使用throws关键字声明异常

- 抛出异常的四种情形：

  - 调用了一个抛出检查型异常的方法，例如，FileInputStream构造器
  - 检测到一个错误，并且利用throw语句抛出一个检查型异常
  - 查询出现错误
  - Java虚拟机或运行时库出现内部错误

- 通过方法的首部的异常规范声明这个方法可能抛出异常

  ```java
  class MyAnimation{
  	public Image loadImage(String s) throws IOException{
  		...
  	}
  }
  ```

  如果一个方法可能抛出多个检查型异常类型，那么就必须在方法的首部列出所有的异常类。每个异常类之间用逗号隔开：

  ```java
  class MyAnimation{
  	...
  	public Image loadImage(String s) throws FileNotFoundException, EOFException{
  		...
  	}
  }
  ```

  不需要声明Java内部错误，即从Error继承的异常，也不需要声明从RuntimeException继承的那些非检查型异常

- 总之，一个方法必须声明所有可能抛出的`检查型`异常，而非检查型异常要么在你的控制之外（Error），要么是由从一开始就应该避免的情况所导致的（RuntimeException）。如果你的方法没有声明所有可能发生的检测型异常，编译器就会发出一个错误消息。
- 如果超类方法没有抛出任何检测型异常，子类也不能抛出任何检测型异常。

### 7.1.3 如何抛出异常

- 需要使用throw关键字抛出异常，异常：

  ```java
  String readData(Scanner in) throws EOFException{
  	while(...){
  		if (! in.hasNext())  //EOF encountered{
  			if(n < len){
  				throw new EOFException();
  			}
  		}
  		return s;
  	}
  }
  ```

  EOFException类还有一个带一个字符串参数的构造器：

  ```java
  String gripe = "Content-length: " + len + ", Received:" + n;
  throw new EOFException(gripe);
  ```

- 以下情况：

  - 找到一个合适的异常类
  - 创建这个类的一个对象
  - 将对象抛出

  一旦方法抛出了异常，这个方法就不会返回到调用者。也就是说，不必操心建立一个默认的返回值或错误码

### 7.1.4 创建异常类

- 当我们的代码遇到任何标准异常类都无法描述清楚的问题时，这是就需要使用自定义的异常类：

  ```java
  class FileFormatException extends IOException{
  	public FileFormatException(){}
  	public FileFormatException(String gripe){
  		super(gripe);
  	}
  }
  ```

  然后将其抛出

- java.lang.Throwable
  - Throwable()：构造一个新的Throwable对象，但没有详细的描述信息
  - Throwable(String message)：构造一个新的throwable对象，带有指定的详细描述信息。按惯例，所有派生的异常类都支持一个默认构造器和一个带有详细描述信息的构造器
  - String getMessage()：获得 Throwable对象的详细描述信息